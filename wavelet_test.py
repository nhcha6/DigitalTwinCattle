# the script runs a multilevel discrete wavelet transformation on selected data. It will be integrated
# into the other scripts which generate data and plots. Currently copying data across from the other
# scripts.

import pywt
import matplotlib.pyplot as plt

#print(pywt.wavelist())

# herd average daily data
resting_other = [28.91339036524438, 29.743780277696214, 29.548863555664244, 28.198968111619028, 23.555879427468266, 16.152823216427205, 11.855278325797151, 13.975960193547476, 18.772238009139247, 18.712357974041424, 20.960513821730213, 21.137531628001128, 18.08575578135764, 20.040312715374775, 20.903118962306536, 16.718056726041063, 11.232885023168569, 11.913087615089177, 24.086679574116133, 35.187223671934156, 33.45383755582282, 32.06214168093001, 29.89823217974353, 29.07008183567694]
resting_hot = [28.563464433677566, 27.920349620921446, 28.56012485175542, 25.46486350246531, 19.72637707120466, 13.865905884100302, 11.223364921337541, 12.120756041740275, 11.359731933289375, 11.174529161706428, 13.58052015563712, 14.489100225714331, 14.058820749515604, 15.326934718374675, 15.934396568602079, 12.428173109164275, 6.791350392805945, 9.800822293284604, 27.69379589393452, 32.60797493963323, 30.941512308519762, 31.251200021603765, 28.504904729649137, 28.325431456431282]
eating_other = [1.4919467734927627, 0.8523586571593762, 0.4766381664761891, 0.6243339255322851, 0.7712789001248006, 1.4670838612262158, 6.300207367542366, 4.890276683755925, 3.357038733163084, 3.237476178568794, 3.010981580600291, 2.901734124289815, 4.112849942277719, 3.3673131174179196, 3.109000089336111, 5.117733333760203, 7.124416680534803, 7.17948687287643, 4.218713111707272, 1.6943811515081626, 1.6437187166598002, 1.8252519256895121, 1.825492087335791, 1.8525396500990046]
eating_hot = [1.5649496924839155, 1.1244106785607393, 0.7655203919282936, 1.2390141482153265, 1.06709319098853, 1.9302873525711854, 5.4931419299813, 4.7849097705275145, 4.88891839403016, 6.232827820247678, 5.284710610823937, 5.095319859485516, 5.520335668490235, 4.92885835356811, 4.3676420616292395, 6.300638886325942, 8.459849628797818, 8.09644505555093, 4.256272405466652, 1.8789041490479717, 2.247183071650235, 1.8181975709267342, 2.137170401942538, 2.1638690541826917]
panting_other = [0.8305604449324365, 0.5318436267415947, 0.3542587996376067, 0.8960814955808648, 2.532859702462344, 3.6497127224395634, 3.611990038165759, 5.285439778606979, 6.477865785497869, 6.765575692425326, 7.073887001415041, 7.47314054359492, 6.900231653499905, 6.729141574713174, 6.483842324627946, 5.122674972938758, 3.3553754455010503, 2.196423347900797, 1.405952906113506, 0.8059778894349816, 0.8804479479899624, 0.917131649995086, 0.9720724776886432, 0.8969175874525778]
panting_hot = [0.512715840735248, 0.4647082254082774, 0.30595431253895994, 1.3694761312158643, 3.8346276838739155, 5.105714420737813, 5.070302250167092, 7.607419092776917, 7.636194856953824, 8.592399975695765, 12.74443646805456, 13.283922973578145, 12.316834958491517, 11.903149873865521, 11.533286675203156, 7.704910580668681, 4.921830378943532, 2.9287413331773053, 1.1415181595392996, 0.992517446164994, 0.9768232114445943, 0.93423679076079, 0.8921702106592072, 0.7067739053530077]

# animal single day data
resting_single = [46, 60, 29, 32, 36, 22, 8, 3, 23, 27, 40, 8, 8, 5, 7, 1, 1, 1, 1, 7, 42, 44, 5, 6]
eating_single = [0, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 0, 1, 20, 3, 7, 2, 8, 11, 6, 0, 0, 12, 8]
panting_single = [0, 0, 0, 5, 0, 6, 5, 5, 3, 11, 20, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 1]

# herd data over consecutive days
# cold
herd_dec_8_dec_11 = [0.5172413793103449, 0.1921182266009852, 0.17733990147783252, 1.1477832512315271, 1.5123152709359606, 2.9704433497536944, 3.9261083743842367, 5.674876847290641, 5.054187192118227, 6.12807881773399, 7.157635467980295, 5.650246305418719, 4.231527093596059, 4.330049261083744, 7.399014778325123, 4.477832512315271, 2.142857142857143, 1.5763546798029557, 1.6650246305418719, 0.3251231527093596, 0.5467980295566502, 0.6108374384236454, 0.6896551724137931, 0.49261083743842365, 0.19704433497536947, 0.270935960591133, 0.1724137931034483, 0.5123152709359606, 2.1724137931034484, 4.832512315270936, 4.103448275862069, 7.472906403940887, 6.694581280788177, 11.9064039408867, 6.768472906403941, 8.187192118226601, 8.187192118226601, 8.187192118226601, 4.926108374384237, 5.226600985221675, 3.7339901477832513, 2.0147783251231526, 1.7733990147783252, 0.4482758620689655, 0.49261083743842365, 0.4482758620689655, 0.4433497536945813, 0.6354679802955665, 0.37438423645320196, 0.21182266009852216, 0.2561576354679803, 0.3497536945812808, 2.0, 3.605911330049261, 5.221674876847291, 8.591133004926109, 9.911330049261084, 7.295566502463054, 8.753694581280788, 7.768472906403941, 7.571428571428571, 6.4088669950738915, 9.827586206896552, 8.620689655172415, 4.645320197044335, 2.270935960591133, 1.4187192118226601, 0.2512315270935961, 1.5024630541871922, 0.20689655172413793, 0.1625615763546798, 0.30049261083743845, 0.3645320197044335, 0.37438423645320196, 0.2315270935960591, 0.37438423645320196, 1.4827586206896552, 4.379310344827586, 6.896551724137931, 8.901477832512315, 11.394088669950738, 8.049261083743842, 11.47783251231527, 9.19704433497537, 10.448275862068966, 8.960591133004925, 5.8817733990147785, 4.246305418719212, 6.753694581280788, 2.083743842364532, 1.4926108374384237, 0.33004926108374383, 0.37438423645320196, 0.47783251231527096, 0.7733990147783252, 0.3891625615763547]
# hot
herd_nov_30_dec_3 = [0.3251231527093596, 0.2315270935960591, 0.2857142857142857, 1.0246305418719213, 3.41871921182266, 5.852216748768473, 10.733990147783251, 10.911330049261084, 10.078817733990148, 7.029556650246305, 10.812807881773399, 10.566502463054187, 12.009852216748769, 10.620689655172415, 12.049261083743842, 9.0935960591133, 5.8817733990147785, 2.2955665024630543, 0.9310344827586207, 0.4433497536945813, 0.33004926108374383, 0.4482758620689655, 0.43842364532019706, 0.1330049261083744, 0.270935960591133, 0.39901477832512317, 0.4630541871921182, 1.2807881773399015, 4.975369458128079, 8.650246305418719, 10.142857142857142, 13.374384236453203, 13.054187192118226, 10.921182266009852, 12.305418719211822, 15.70935960591133, 13.886699507389162, 15.399014778325123, 13.492610837438423, 9.177339901477833, 9.073891625615763, 3.6403940886699506, 0.8472906403940886, 0.3694581280788177, 0.39408866995073893, 0.541871921182266, 0.31527093596059114, 0.35467980295566504, 0.4630541871921182, 0.7339901477832512, 0.5270935960591133, 3.2758620689655173, 9.625615763546797, 11.19704433497537, 5.768472906403941, 1.438423645320197, 4.586206896551724, 6.551724137931035, 11.827586206896552, 13.566502463054187, 10.320197044334975, 10.655172413793103, 10.67487684729064, 9.389162561576354, 4.773399014778325, 5.827586206896552, 0.7881773399014779, 0.4729064039408867, 0.45320197044334976, 0.5615763546798029, 0.5024630541871922, 0.6995073891625616, 0.5763546798029556, 0.3497536945812808, 0.27586206896551724, 2.9310344827586206, 7.231527093596059, 9.793103448275861, 9.733990147783251, 14.77832512315271, 9.413793103448276, 9.334975369458128, 8.817733990147783, 11.201970443349754, 14.039408866995075, 13.650246305418719, 10.753694581280788, 7.847290640394089, 7.413793103448276, 2.773399014778325, 0.8669950738916257, 0.5960591133004927, 0.5320197044334976, 0.5960591133004927, 0.7192118226600985, 0.30049261083743845]
herd_nov_4_nov_7 = [0.6699507389162561, 0.2413793103448276, 0.24630541871921183, 0.7980295566502463, 2.2413793103448274, 3.167487684729064, 2.7635467980295565, 7.206896551724138, 5.876847290640394, 10.266009852216749, 11.29064039408867, 7.817733990147783, 6.16256157635468, 8.630541871921181, 6.502463054187192, 5.295566502463054, 2.8374384236453203, 2.7339901477832513, 0.8423645320197044, 1.6403940886699508, 1.4039408866995073, 0.896551724137931, 0.8325123152709359, 0.625615763546798, 0.6009852216748769, 0.2955665024630542, 0.23645320197044334, 0.7389162561576355, 2.625615763546798, 3.4433497536945814, 3.4926108374384235, 11.113300492610838, 8.852216748768473, 10.58128078817734, 12.029556650246306, 14.438423645320198, 13.201970443349754, 10.374384236453203, 9.724137931034482, 4.748768472906404, 2.9211822660098523, 2.9261083743842367, 1.3645320197044335, 2.2758620689655173, 1.5812807881773399, 1.4532019704433496, 1.0935960591133005, 1.2758620689655173, 0.7241379310344828, 0.9408866995073891, 0.4039408866995074, 1.896551724137931, 3.4433497536945814, 3.980295566502463, 3.3004926108374386, 10.87192118226601, 11.758620689655173, 8.344827586206897, 14.12807881773399, 15.852216748768473, 13.89655172413793, 13.364532019704434, 11.45320197044335, 4.467980295566503, 2.064039408866995, 3.064039408866995, 2.206896551724138, 2.226600985221675, 1.5960591133004927, 2.3300492610837438, 1.5960591133004927, 1.477832512315271, 0.2857142857142857, 0.24630541871921183, 0.12807881773399016, 1.1083743842364533, 3.438423645320197, 3.064039408866995, 1.5911330049261083, 1.645320197044335, 1.2216748768472907, 1.0295566502463054, 15.645320197044335, 14.970443349753694, 11.344827586206897, 6.556650246305419, 12.758620689655173, 9.467980295566502, 5.812807881773399, 2.9852216748768474, 1.206896551724138, 1.3201970443349753, 2.142857142857143, 0.9113300492610837, 1.5123152709359606, 0.6009852216748769]

# single animal panting data over consecutive days
# cold period data
panting_8022092_dec_8_dec_11 = [0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 5.0, 5.0, 3.0, 11.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 2.0, 8.0, 2.0, 21.0, 6.0, 16.0, 4.0, 2.0, 0.0, 14.0, 17.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 4.0, 0.0, 0.0, 8.0, 3.0, 5.0, 10.0, 8.0, 25.0, 9.0, 19.0, 5.0, 24.0, 34.0, 1.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 16.0, 30.0, 20.0, 20.0, 19.0, 20.0, 24.0, 11.0, 14.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# hot period data
panting_8022092_nov_4_nov_7 = [0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 0.0, 11.0, 13.0, 10.0, 42.0, 35.0, 12.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 3.0, 11.0, 11.0, 0.0, 1.0, 26.0, 43.0, 3.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 27.0, 12.0, 11.0, 0.0, 4.0, 5.0, 11.0, 15.0, 0.0, 2.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 26.0, 24.0, 14.0, 19.0, 5.0, 6.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0]

# single animal eating data over consecutive days
# hot
eating_8022092_nov_30_dec_3 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 13.0, 0.0, 0.0, 18.0, 2.0, 0.0, 0.0, 10.0, 12.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 7.0, 18.0, 6.0, 11.0, 8.0, 0.0, 2.0, 8.0, 28.0, 13.0, 0.0, 0.0, 29.0, 11.0, 25.0, 27.0, 17.0, 30.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 11.0, 13.0, 10.0, 15.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 19.0, 48.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 8.0, 27.0, 20.0, 0.0, 0.0, 8.0, 0.0, 0.0]
#cold
eating_8022092_nov_4_nov_7 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 24.0, 10.0, 4.0, 14.0, 3.0, 4.0, 8.0, 4.0, 6.0, 16.0, 0.0, 3.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 10.0, 28.0, 18.0, 27.0, 44.0, 30.0, 17.0, 5.0, 13.0, 19.0, 7.0, 0.0, 0.0, 0.0, 45.0, 19.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 8.0, 16.0, 9.0, 25.0, 25.0, 0.0, 4.0, 6.0, 6.0, 2.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 2.0, 1.0, 9.0, 9.0, 6.0, 16.0, 2.0, 12.0, 6.0, 13.0, 1.0, 0.0, 6.0, 0.0, 4.0, 14.0]

# select state:
state_single = eating_8022092_nov_4_nov_7
state_hot = []
state_other = []
for i in range(int(len(state_single)/24)):
    state_hot += eating_hot
    state_other += eating_other

# run DWT
coefs_other = pywt.wavedec(state_other, 'bior2.2', level=2)
cA2o, cD2o, cD1o = coefs_other

coefs_hot = pywt.wavedec(state_hot, 'bior2.2', level=2)
cA2h, cD2h, cD1h = coefs_hot

coefs_comp = pywt.wavedec(state_single, 'bior2.2', level=2)
cA2c, cD2c, cD1c = coefs_comp

plt.figure(2, figsize=(8,7))
plt.subplot(4, 1, 1)
plt.plot(state_other, label = 'herd_cold')
plt.plot(state_hot, label = 'herd_hot')
plt.plot(state_single, label = '8022092')
plt.title("Signal")
plt.legend(loc="upper right")

plt.subplot(4,1,2)
plt.plot(cA2o)
plt.plot(cA2h)
plt.plot(cA2c)
plt.title("Second Approximate")

plt.subplot(4,1,3)
plt.plot(cD2o)
plt.plot(cD2h)
plt.plot(cD2c)
plt.title("Second Detail")

plt.subplot(4,1,4)
plt.plot(cD1o)
plt.plot(cD1h)
plt.plot(cD1c)
plt.title("First Detail")

plt.tight_layout()
plt.show()